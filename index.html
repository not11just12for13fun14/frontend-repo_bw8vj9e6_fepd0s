<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>DuraSim — Group eSIM (Dark)</title>
  <meta name="description" content="DuraSim is the world’s first group‑eSIM platform." />
  <style>
    :root{
      --bg:#0A0A0A;          /* background */
      --card:#1A1A1A;        /* cards */
      --teal:#00A99D;        /* accents */
      --orange:#FF6B35;      /* CTAs & glows */
      --text:#EDEDED;        /* light text */
      --muted:#a1a1aa;       /* muted */
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background:var(--bg); color:var(--text); font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji";
      overflow-x:hidden;
    }
    a{color:inherit; text-decoration:none}

    /* Canvases fill viewport */
    .stage{position:fixed; inset:0; pointer-events:none}
    #stars{z-index:0}
    #globe{z-index:1}

    /* Header */
    .header{position:fixed; top:14px; left:14px; z-index:5; display:flex; align-items:center; gap:.6rem}
    .logo-dot{width:12px; height:12px; border-radius:50%; background:var(--teal); box-shadow:0 0 18px rgba(0,169,157,.6)}
    .brand{font-weight:800; letter-spacing:.2px}
    .burger{appearance:none; background:rgba(255,255,255,.06); color:#fff; border:1px solid rgba(255,255,255,.08); padding:8px 10px; border-radius:10px; cursor:pointer; margin-left:8px; backdrop-filter:blur(6px); transition:transform .2s ease}
    .burger:hover{transform:translateY(-1px)}

    /* Nav overlay */
    .overlay{position:fixed; inset:0; background:rgba(10,10,10,.7); backdrop-filter:blur(12px); display:grid; place-items:center; opacity:0; pointer-events:none; transition:opacity .25s ease; z-index:10}
    .overlay.open{opacity:1; pointer-events:auto}
    .drawer{background:#111; border:1px solid #2a2a2a; width:min(92vw,420px); border-radius:16px; padding:18px; box-shadow:0 40px 120px rgba(0,0,0,.6); transform:translateY(12px); opacity:0; transition:opacity .25s ease, transform .25s ease}
    .overlay.open .drawer{transform:none; opacity:1}
    .nav-links{display:grid; gap:12px}
    .nav-links a{display:block; padding:12px 14px; border-radius:12px; background:rgba(255,255,255,.04); border:1px solid rgba(255,255,255,.06)}

    /* Floating tiles */
    .tile{position:fixed; z-index:4; background:rgba(26,26,26,.78); color:var(--text); border:1px solid rgba(255,255,255,.08); border-radius:14px; padding:12px; backdrop-filter:blur(6px); box-shadow:0 12px 40px rgba(0,0,0,.5); width:210px; transform-origin:center; transition:transform .2s ease, box-shadow .2s ease, background .2s ease, border-color .2s ease;}
    .tile:hover{transform:translateY(-2px)}
    .tile h4{margin:0 0 6px 0; font-size:14px; letter-spacing:.2px}
    .tile .row{display:flex; align-items:center; justify-content:space-between; gap:10px}
    .tile .muted{color:var(--muted); font-size:12px}
    .tile input[type=range]{width:100%}
    .tile .cta{margin-top:8px; display:none}
    .tile.expanded{background:rgba(26,26,26,.92); border-color:#333}
    .tile.expanded .cta{display:block}
    .btn{display:inline-flex; align-items:center; justify-content:center; gap:.5rem; border:none; cursor:pointer; font-weight:800; letter-spacing:.2px; border-radius:999px; padding:10px 14px; transition:transform .18s ease, box-shadow .18s ease}
    .btn.orange{background:var(--orange); color:#111; box-shadow:0 8px 26px rgba(255,107,53,.35)}
    .btn.orange:hover{transform:translateY(-2px)}
    .btn.teal{background:rgba(0,169,157,.18); color:#c8fffa; border:1px solid rgba(0,169,157,.4)}

    /* Hotspots */
    .hotspot{position:fixed; z-index:3; width:18px; height:18px; border-radius:50%; background:var(--orange); box-shadow:0 0 18px rgba(255,107,53,.8), 0 0 40px rgba(255,107,53,.35) inset; transform:translate(-50%,-50%); pointer-events:auto}

    /* Scroll indicator */
    .scroll-ind{position:fixed; left:50%; bottom:18px; transform:translateX(-50%); z-index:4; opacity:1; transition:opacity .6s ease}
    .scroll-ind.hide{opacity:0}

    /* Referral strip */
    .ref-strip{position:fixed; left:0; right:0; bottom:0; z-index:6; background:var(--orange); color:#111; display:flex; align-items:center; justify-content:center; gap:12px; padding:10px 14px; font-weight:700; box-shadow:0 -10px 30px rgba(255,107,53,.2)}
    .ref-strip button{background:#111; color:#fff; border:none; padding:8px 12px; border-radius:10px; cursor:pointer}

    /* Share modal */
    .share{position:fixed; inset:0; z-index:20; display:grid; place-items:center; background:rgba(0,0,0,.6); opacity:0; pointer-events:none; transition:opacity .2s ease}
    .share.open{opacity:1; pointer-events:auto}
    .sheet{background:#111; border:1px solid #2b2b2b; color:#fff; border-radius:16px; width:min(92vw, 520px); padding:18px; box-shadow:0 40px 120px rgba(0,0,0,.6)}
    .sheet .row{display:flex; gap:10px}
    .sheet input{flex:1; padding:10px 12px; border-radius:10px; border:1px solid #2b2b2b; background:#0f0f0f; color:#fff}
    .sheet button{padding:10px 12px; border-radius:10px; border:1px solid #2b2b2b; background:var(--orange); color:#111; font-weight:800; cursor:pointer}

    /* Text blocks fade-in */
    .text-block{position:fixed; right:14px; top:14px; z-index:4; max-width:40ch; opacity:0; transform:translateY(8px); transition:opacity .6s ease, transform .6s ease}
    .text-block.show{opacity:1; transform:none}
  </style>
</head>
<body>
  <!-- Parallax stars and Globe canvases -->
  <canvas id="stars" class="stage" aria-hidden="true"></canvas>
  <canvas id="globe" class="stage" aria-label="Interactive globe"></canvas>

  <!-- Header with brand + burger -->
  <div class="header">
    <div class="logo-dot"></div>
    <div class="brand" style="color:var(--teal)">Dura</div><div class="brand">Sim</div>
    <button id="burger" class="burger" aria-label="Open navigation">≡</button>
  </div>

  <!-- Slide-in nav overlay -->
  <div id="navOverlay" class="overlay" aria-hidden="true">
    <div class="drawer">
      <div style="display:flex; align-items:center; justify-content:space-between; margin-bottom:10px">
        <div style="display:flex; align-items:center; gap:8px"><span class="logo-dot"></span><strong>DuraSim</strong></div>
        <button id="closeNav" class="burger" aria-label="Close">Close</button>
      </div>
      <nav class="nav-links">
        <a href="#">How it Works</a>
        <a href="#">Pricing</a>
        <a href="#">Support</a>
        <a href="#">Partnerships</a>
        <a href="#">SDK</a>
      </nav>
    </div>
  </div>

  <!-- Floating tiles for each region -->
  <div id="tile-asia" class="tile" role="dialog" aria-label="Asia plan">
    <h4>Asia</h4>
    <div class="row"><span class="muted">Base £xxx + £xxx per extra traveler</span></div>
    <div class="row" style="margin-top:8px">
      <input type="range" min="0" max="10" value="0" data-region="asia" class="micro" />
      <span id="count-asia" class="muted">0</span>
    </div>
    <div class="row" style="margin-top:6px"><strong>Total £xxx</strong></div>
    <div class="cta">
      <div class="row" style="margin-top:8px"><span class="btn teal">Add Friends</span><button class="btn orange">Create Group Plan</button></div>
    </div>
  </div>
  <div id="tile-europe" class="tile" role="dialog" aria-label="Europe plan">
    <h4>Europe</h4>
    <div class="row"><span class="muted">Base £xxx + £xxx per extra traveler</span></div>
    <div class="row" style="margin-top:8px">
      <input type="range" min="0" max="10" value="0" data-region="europe" class="micro" />
      <span id="count-europe" class="muted">0</span>
    </div>
    <div class="row" style="margin-top:6px"><strong>Total £xxx</strong></div>
    <div class="cta">
      <div class="row" style="margin-top:8px"><span class="btn teal">Add Friends</span><button class="btn orange">Create Group Plan</button></div>
    </div>
  </div>
  <div id="tile-americas" class="tile" role="dialog" aria-label="Americas plan">
    <h4>Americas</h4>
    <div class="row"><span class="muted">Base £xxx + £xxx per extra traveler</span></div>
    <div class="row" style="margin-top:8px">
      <input type="range" min="0" max="10" value="0" data-region="americas" class="micro" />
      <span id="count-americas" class="muted">0</span>
    </div>
    <div class="row" style="margin-top:6px"><strong>Total £xxx</strong></div>
    <div class="cta">
      <div class="row" style="margin-top:8px"><span class="btn teal">Add Friends</span><button class="btn orange">Create Group Plan</button></div>
    </div>
  </div>

  <!-- Hotspots -->
  <div id="hs-asia" class="hotspot" title="Asia"></div>
  <div id="hs-europe" class="hotspot" title="Europe"></div>
  <div id="hs-americas" class="hotspot" title="Americas"></div>

  <!-- Subtle helper text -->
  <div id="heroText" class="text-block">
    <div style="font-size:12px; color:var(--muted); margin-bottom:4px">World’s first group‑eSIM</div>
    <div style="font-size:20px; font-weight:800; line-height:1.1">One Plan. Multiple Travelers. Zero Hassle.</div>
    <div style="font-size:13px; color:var(--muted); margin-top:6px">DuraSim is the world’s first group eSIM platform—built for travelers, not telecoms.</div>
  </div>

  <!-- Scroll indicator -->
  <div id="scrollInd" class="scroll-ind" aria-hidden="true">
    <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="var(--orange)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
  </div>

  <!-- Referral strip -->
  <div class="ref-strip">
    <span>Traveling with friends? Earn £xxx credit per referral — Invite Friends</span>
    <button id="invite">Invite</button>
  </div>

  <!-- Share modal -->
  <div id="share" class="share" aria-hidden="true">
    <div class="sheet">
      <h3 style="margin:0 0 8px 0">Invite friends</h3>
      <p style="margin:0 0 10px 0; color:#c9c9c9">Share your link and earn £xxx credit per referral.</p>
      <div class="row">
        <input id="refLink" value="https://durasim.example/ref?code=YOUR-CODE" readonly />
        <button id="copy">Copy</button>
      </div>
    </div>
  </div>

  <script>
  (function(){
    const log = (...args)=>console.log('[DEBUG]', ...args);

    // Canvases and sizes
    const stars = document.getElementById('stars');
    const globe = document.getElementById('globe');
    const dpr = Math.min(2, window.devicePixelRatio || 1);
    function resize(){
      const w = window.innerWidth, h = window.innerHeight;
      [stars, globe].forEach(c=>{ c.width = Math.floor(w*dpr); c.height = Math.floor(h*dpr); c.style.width=w+'px'; c.style.height=h+'px'; });
      sctx.setTransform(dpr,0,0,dpr,0,0);
      gctx.setTransform(dpr,0,0,dpr,0,0);
      updatePositions();
    }
    const sctx = stars.getContext('2d');
    const gctx = globe.getContext('2d');

    // Star field
    const STAR_COUNT = 160;
    const starField = Array.from({length:STAR_COUNT}, ()=>({ x: Math.random(), y: Math.random(), r: Math.random()*1.2 + .2, o: .3 + Math.random()*.7 }));
    function drawStars(offsetY=0){
      const w = window.innerWidth, h = window.innerHeight;
      sctx.clearRect(0,0,w,h);
      sctx.fillStyle = '#000'; sctx.fillRect(0,0,w,h);
      for(const s of starField){
        const px = s.x * w;
        const py = (s.y * h) + offsetY * (0.08 + s.r*0.02);
        sctx.beginPath(); sctx.arc(px, ((py%h)+h)%h, s.r, 0, Math.PI*2); sctx.closePath();
        sctx.fillStyle = `rgba(255,255,255,${s.o})`;
        sctx.fill();
      }
    }

    // Simple 3D globe drawn in 2D canvas (shaded sphere + meridians)
    let rotY = -1.815; // start facing Asia
    let rotYTarget = rotY;
    let tiltX = 0.18;  // slight tilt
    const stepRad = (30*Math.PI/180);

    function drawGlobe(){
      const w = window.innerWidth, h = window.innerHeight;
      const cx=w/2, cy=h/2; const R = Math.min(w,h)*0.35;
      gctx.clearRect(0,0,w,h);

      // Sphere lighting
      const grad = gctx.createRadialGradient(cx - R*0.3, cy - R*0.3, R*0.2, cx, cy, R*1.2);
      grad.addColorStop(0, '#0f2b29');
      grad.addColorStop(1, '#0c1413');
      gctx.fillStyle = grad; gctx.beginPath(); gctx.arc(cx,cy,R,0,Math.PI*2); gctx.fill();

      // Atmosphere glow
      const glowGrad = gctx.createRadialGradient(cx, cy, R*0.9, cx, cy, R*1.3);
      glowGrad.addColorStop(0, 'rgba(0,169,157,0.0)');
      glowGrad.addColorStop(1, 'rgba(0,169,157,0.25)');
      gctx.fillStyle = glowGrad; gctx.beginPath(); gctx.arc(cx,cy,R*1.15,0,Math.PI*2); gctx.fill();

      // Meridians/Parallels for hint of 3D
      gctx.lineWidth = 1;
      gctx.strokeStyle = 'rgba(255,255,255,.06)';
      for(let lat=-60; lat<=60; lat+=30){ drawCircleLat(lat); }
      for(let lon=0; lon<180; lon+=30){ drawCircleLon(lon); }

      function project(lat, lon){
        // Convert to 3D unit sphere, apply rotations, then project to 2D
        const toRad = Math.PI/180; lat*=toRad; lon*=toRad;
        let x = Math.cos(lat)*Math.cos(lon);
        let y = Math.sin(lat);
        let z = Math.cos(lat)*Math.sin(lon);
        // rotate around X (tilt)
        let y2 = y*Math.cos(tiltX) - z*Math.sin(tiltX);
        let z2 = y*Math.sin(tiltX) + z*Math.cos(tiltX);
        y = y2; z = z2;
        // rotate around Y (spin)
        let x2 = x*Math.cos(rotY) + z*Math.sin(rotY);
        z2 = -x*Math.sin(rotY) + z*Math.cos(rotY);
        x = x2; z = z2;
        const scale = R * 1.2 / (2.2 - z); // simple perspective
        const sx = cx + x*scale;
        const sy = cy - y*scale;
        const visible = z > -0.2; // simple visibility check
        return {x:sx, y:sy, visible, z};
      }
      function drawCircleLat(lat){
        const pts=[]; for(let lon=-180; lon<=180; lon+=6){ const p=project(lat,lon); if(p.visible) pts.push(p); }
        if(pts.length<2) return; gctx.beginPath(); gctx.moveTo(pts[0].x, pts[0].y); for(const p of pts) gctx.lineTo(p.x,p.y); gctx.stroke();
      }
      function drawCircleLon(lon){
        const pts=[]; for(let lat=-80; lat<=80; lat+=6){ const p=project(lat,lon); if(p.visible) pts.push(p); }
        if(pts.length<2) return; gctx.beginPath(); gctx.moveTo(pts[0].x, pts[0].y); for(const p of pts) gctx.lineTo(p.x,p.y); gctx.stroke();
      }

      // Update hotspot and tile positions
      function place(region){
        const p = project(region.lat, region.lon);
        const hs = document.getElementById('hs-'+region.key);
        const tile = document.getElementById('tile-'+region.key);
        if(hs){ hs.style.left = p.x+'px'; hs.style.top = p.y+'px'; hs.style.opacity = p.visible?1:0; }
        if(tile){ const tx = p.x + (region.tileOffsetX|| 24), ty = p.y + (region.tileOffsetY|| -24);
          tile.style.left = Math.max(10, Math.min(window.innerWidth-220, tx)) + 'px';
          tile.style.top = Math.max(10, Math.min(window.innerHeight-140, ty)) + 'px';
          tile.style.opacity = p.visible?1:0.96;
        }
      }
      regions.forEach(place);
    }

    // Regions
    const regions = [
      { key:'asia',     lat:  1.3, lon:103.8, tileOffsetX:  28, tileOffsetY:-40, facing:- (103.8*Math.PI/180) },
      { key:'europe',   lat: 50.1, lon:  8.6, tileOffsetX: -240, tileOffsetY:-20, facing:- (  8.6*Math.PI/180) },
      { key:'americas', lat: 19.4, lon:-99.1, tileOffsetX:  28, tileOffsetY: 28, facing:- (-99.1*Math.PI/180) }
    ];
    let regionIndex = 0;

    function currentRegion(){
      // Determine which region faces closest to center (rotY ≈ region.facing)
      let minD=1e9, idx=0; regions.forEach((r,i)=>{ const d = Math.abs(angleDelta(rotY, r.facing)); if(d<minD){minD=d; idx=i;} });
      return idx;
    }
    function angleDelta(a,b){ let d = a-b; while(d> Math.PI) d-=Math.PI*2; while(d<-Math.PI) d+=Math.PI*2; return d; }
    function stepToRegion(dir){
      regionIndex = (regionIndex + (dir>0?1:-1) + regions.length) % regions.length;
      rotYTarget = regions[regionIndex].facing;
      log('scroll-step -> region', regions[regionIndex].key);
    }

    // Scroll logic: step through regions; also apply smooth spin based on delta
    let firstScroll = true;
    function onWheel(e){
      e.preventDefault();
      if(firstScroll){ document.getElementById('scrollInd').classList.add('hide'); firstScroll=false; }
      const dir = Math.sign(e.deltaY);
      stepToRegion(dir);
      log('wheel', {deltaY:e.deltaY, target:rotYTarget});
    }
    window.addEventListener('wheel', onWheel, {passive:false});

    // Touch swipe for mobile
    let tsY=null; window.addEventListener('touchstart', (e)=>{ tsY=e.touches[0].clientY; }, {passive:true});
    window.addEventListener('touchend', (e)=>{ if(tsY==null) return; const dy=(e.changedTouches[0].clientY - tsY); if(Math.abs(dy)>24){ stepToRegion(dy<0?1:-1); if(firstScroll){ document.getElementById('scrollInd').classList.add('hide'); firstScroll=false; } } tsY=null; }, {passive:true});

    // Mouse move to steer slightly
    globe.addEventListener('pointermove', (e)=>{
      const x = (e.clientX / window.innerWidth) - .5;
      rotYTarget += x * 0.0005 * window.innerWidth; // tiny steer
    }, {passive:true});

    // Snapping to 30° grid when close
    function applySnap(){
      const snap = Math.round(rotYTarget/stepRad)*stepRad;
      if(Math.abs(angleDelta(rotYTarget, snap)) < (5*Math.PI/180)){
        rotYTarget = snap;
      }
    }

    // Animate
    let lastY=0; let t=0;
    function frame(){
      t += 1/60;
      drawStars(window.scrollY * -0.15);
      applySnap();
      rotY += angleDelta(rotYTarget, rotY) * 0.08;
      drawGlobe();

      // Pulse hotspots
      const s = 1 + Math.sin(t*2)*0.2;
      ['asia','europe','americas'].forEach(k=>{ const el=document.getElementById('hs-'+k); el.style.transform = `translate(-50%,-50%) scale(${s})`; });

      // Log region on change
      const idx = currentRegion();
      if(idx !== lastY){ lastY = idx; log('region', regions[idx].key); }

      requestAnimationFrame(frame);
    }

    // Interactions: tiles and hotspots
    function setupTile(key){
      const tile = document.getElementById('tile-'+key);
      const hs = document.getElementById('hs-'+key);
      const slider = tile.querySelector('input[type=range]');
      slider.addEventListener('input', ()=>{
        document.getElementById('count-'+key).textContent = slider.value;
        log('slider', {region:key, value:slider.value, total:'£xxx'});
      });
      function toggleExpand(){ tile.classList.toggle('expanded'); log('tile-toggle', {region:key, expanded:tile.classList.contains('expanded')}); }
      tile.addEventListener('click', (e)=>{ toggleExpand(); e.stopPropagation(); });
      hs.addEventListener('click', (e)=>{ toggleExpand(); e.stopPropagation(); });
      hs.addEventListener('pointerenter', ()=>{ hs.style.boxShadow='0 0 24px rgba(255,107,53,.95), 0 0 50px rgba(255,107,53,.45) inset'; log('hotspot-hover', {region:key}); });
      hs.addEventListener('pointerleave', ()=>{ hs.style.boxShadow='0 0 18px rgba(255,107,53,.8), 0 0 40px rgba(255,107,53,.35) inset'; });
      tile.querySelectorAll('.btn').forEach(btn=> btn.addEventListener('click', (e)=>{ log('cta', {region:key, action:btn.textContent.trim()}); e.stopPropagation(); }));
    }
    ['asia','europe','americas'].forEach(setupTile);

    // Header/nav
    const nav = document.getElementById('navOverlay');
    document.getElementById('burger').addEventListener('click', ()=>{ nav.classList.add('open'); log('nav','open'); });
    document.getElementById('closeNav').addEventListener('click', ()=>{ nav.classList.remove('open'); log('nav','close'); });
    nav.addEventListener('click', (e)=>{ if(e.target===nav){ nav.classList.remove('open'); log('nav','close-backdrop'); } });

    // Referral
    const share = document.getElementById('share');
    document.getElementById('invite').addEventListener('click', ()=>{ share.classList.add('open'); log('referral','open'); });
    share.addEventListener('click', (e)=>{ if(e.target===share){ share.classList.remove('open'); log('referral','close-backdrop'); } });
    document.getElementById('copy').addEventListener('click', ()=>{
      const v = document.getElementById('refLink').value; navigator.clipboard && navigator.clipboard.writeText(v);
      log('referral','copy', v);
    });

    // Text block appear
    setTimeout(()=>{ document.getElementById('heroText').classList.add('show'); }, 300);

    // Init
    window.addEventListener('resize', resize);
    resize();
    requestAnimationFrame(frame);

    function updatePositions(){ drawGlobe(); }

  })();
  </script>
</body>
</html>
