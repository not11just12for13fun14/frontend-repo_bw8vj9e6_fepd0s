<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>DuraSim — Simple Plans + 3D Globe</title>
  <meta name="description" content="Choose a region — the globe snaps there. Simple, fast, and ready for solo or group later." />
  <style>
    :root{
      --bg:#0A0A0A;
      --card:#1A1A1A;
      --teal:#00A99D;
      --orange:#FF6B35;
      --text:#EDEDED;
      --muted:#a1a1aa;
      --ring:#2f2f2f;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{ margin:0; background:var(--bg); color:var(--text); font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji"; overflow:hidden; }
    a{color:inherit; text-decoration:none}

    /* Layers */
    #three-stage{position:fixed; inset:0; z-index:0; background:radial-gradient(1200px 600px at 50% -100px, rgba(255,107,53,.08), transparent), #0A0A0A}
    #stars{position:fixed; inset:0; z-index:0; pointer-events:none}

    /* Header */
    .header{position:fixed; top:14px; left:14px; z-index:5; display:flex; align-items:center; gap:.6rem}
    .logo-dot{width:12px; height:12px; border-radius:50%; background:var(--teal); box-shadow:0 0 18px rgba(0,169,157,.6)}
    .brand{font-weight:800; letter-spacing:.2px}
    .burger{appearance:none; background:rgba(255,255,255,.06); color:#fff; border:1px solid rgba(255,255,255,.08); padding:8px 10px; border-radius:10px; cursor:pointer; margin-left:8px; backdrop-filter:blur(6px); transition:transform .2s ease}
    .burger:hover{transform:translateY(-1px)}

    /* Nav overlay */
    .overlay{position:fixed; inset:0; background:rgba(10,10,10,.7); backdrop-filter:blur(12px); display:grid; place-items:center; opacity:0; pointer-events:none; transition:opacity .25s ease; z-index:10}
    .overlay.open{opacity:1; pointer-events:auto}
    .drawer{background:#111; border:1px solid #2a2a2a; width:min(92vw,420px); border-radius:16px; padding:18px; box-shadow:0 40px 120px rgba(0,0,0,.6); transform:translateY(12px); opacity:0; transition:opacity .25s ease, transform .25s ease}
    .overlay.open .drawer{transform:none; opacity:1}
    .nav-links{display:grid; gap:12px}
    .nav-links a{display:block; padding:12px 14px; border-radius:12px; background:rgba(255,255,255,.04); border:1px solid rgba(255,255,255,.06)}

    /* Hotspots (remain on globe) */
    .hotspot{position:fixed; z-index:3; width:18px; height:18px; border-radius:50%; background:var(--orange); box-shadow:0 0 16px rgba(255,107,53,.85), 0 0 30px rgba(255,107,53,.35) inset; transform:translate(-50%,-50%); pointer-events:auto; opacity:.95}
    .hotspot::after{content:""; position:absolute; inset:-8px; border-radius:inherit; border:1px solid rgba(255,107,53,.5); animation:pulse 1.8s infinite ease-out}
    @keyframes pulse{0%{transform:scale(0.9); opacity:.9} 70%{transform:scale(1.3); opacity:0} 100%{opacity:0}}

    /* Plans panel (static) */
    .plans{position:fixed; top:50%; right:14px; transform:translateY(-50%); z-index:4; display:flex; flex-direction:column; gap:12px; width:min(92vw, 320px)}
    .plan{background:rgba(26,26,26,.9); border:1px solid var(--ring); border-radius:14px; padding:14px; box-shadow:0 16px 44px rgba(0,0,0,.45)}
    .plan h4{margin:0 0 4px 0; font-size:16px}
    .plan .muted{color:var(--muted); font-size:12px}
    .plan .row{display:flex; align-items:center; justify-content:space-between; gap:10px}
    .plan .btn{margin-top:10px; display:inline-flex; align-items:center; justify-content:center; gap:.5rem; border:none; cursor:pointer; font-weight:800; letter-spacing:.2px; border-radius:999px; padding:10px 14px; transition:transform .18s ease, box-shadow .18s ease; background:var(--orange); color:#111; box-shadow:0 8px 26px rgba(255,107,53,.35)}
    .plan .btn:hover{transform:translateY(-2px)}
    .plan.sel{border-color:rgba(0,169,157,.6); box-shadow:0 0 0 3px rgba(0,169,157,.15) inset}
    .mini{font-size:11px; color:#cfcfcf; margin-top:6px}

    /* Text block */
    .text-block{position:fixed; left:14px; bottom:14px; z-index:4; max-width:44ch; opacity:0; transform:translateY(8px); transition:opacity .6s ease, transform .6s ease}
    .text-block.show{opacity:1; transform:none}

    /* Scroll indicator */
    .scroll-ind{position:fixed; left:50%; bottom:18px; transform:translateX(-50%); z-index:4; opacity:1; transition:opacity .6s ease}
    .scroll-ind.hide{opacity:0}

    /* Referral strip */
    .ref-strip{position:fixed; left:0; right:0; bottom:0; z-index:6; background:var(--orange); color:#111; display:flex; align-items:center; justify-content:center; gap:12px; padding:10px 14px; font-weight:700; box-shadow:0 -10px 30px rgba(255,107,53,.2)}
    .ref-strip button{background:#111; color:#fff; border:none; padding:8px 12px; border-radius:10px; cursor:pointer}

    /* Share modal */
    .share{position:fixed; inset:0; z-index:20; display:grid; place-items:center; background:rgba(0,0,0,.6); opacity:0; pointer-events:none; transition:opacity .2s ease}
    .share.open{opacity:1; pointer-events:auto}
    .sheet{background:#111; border:1px solid #2b2b2b; color:#fff; border-radius:16px; width:min(92vw, 520px); padding:18px; box-shadow:0 40px 120px rgba(0,0,0,.6)}
    .sheet .row{display:flex; gap:10px}
    .sheet input{flex:1; padding:10px 12px; border-radius:10px; border:1px solid #2b2b2b; background:#0f0f0f; color:#fff}
    .sheet button{padding:10px 12px; border-radius:10px; border:1px solid #2b2b2b; background:var(--orange); color:#111; font-weight:800; cursor:pointer}

    /* Responsive: plans dock to bottom on narrow screens */
    @media (max-width: 780px){
      .plans{left:0; right:0; bottom:64px; top:auto; transform:none; flex-direction:row; overflow:auto; padding:0 14px; width:100%}
      .plan{min-width:240px}
      .text-block{left:14px; right:14px; bottom:84px}
    }
  </style>
</head>
<body>
  <canvas id="stars" aria-hidden="true"></canvas>
  <div id="three-stage" aria-label="3D globe"></div>

  <!-- Header with brand + burger -->
  <div class="header">
    <div class="logo-dot"></div>
    <div class="brand" style="color:var(--teal)">Dura</div><div class="brand">Sim</div>
    <button id="burger" class="burger" aria-label="Open navigation">≡</button>
  </div>

  <!-- Slide-in nav overlay -->
  <div id="navOverlay" class="overlay" aria-hidden="true">
    <div class="drawer">
      <div style="display:flex; align-items:center; justify-content:space-between; margin-bottom:10px">
        <div style="display:flex; align-items:center; gap:8px"><span class="logo-dot"></span><strong>DuraSim</strong></div>
        <button id="closeNav" class="burger" aria-label="Close">Close</button>
      </div>
      <nav class="nav-links">
        <a href="#">How it Works</a>
        <a href="#">Pricing</a>
        <a href="#">Support</a>
        <a href="#">Partnerships</a>
        <a href="#">SDK</a>
      </nav>
    </div>
  </div>

  <!-- Hotspots (globe-only markers) -->
  <div id="hs-asia" class="hotspot" title="Asia"></div>
  <div id="hs-europe" class="hotspot" title="Europe"></div>
  <div id="hs-americas" class="hotspot" title="Americas"></div>

  <!-- Plans (static) -->
  <div class="plans" id="plans">
    <div class="plan" data-key="asia">
      <h4>Asia</h4>
      <div class="row"><span class="muted">£xxx · add travelers anytime</span></div>
      <button class="btn">Choose Plan</button>
      <div class="mini">Covers key destinations across APAC.</div>
    </div>
    <div class="plan" data-key="europe">
      <h4>Europe</h4>
      <div class="row"><span class="muted">£xxx · add travelers anytime</span></div>
      <button class="btn">Choose Plan</button>
      <div class="mini">Works across the EU and UK.</div>
    </div>
    <div class="plan" data-key="americas">
      <h4>Americas</h4>
      <div class="row"><span class="muted">£xxx · add travelers anytime</span></div>
      <button class="btn">Choose Plan</button>
      <div class="mini">From Canada to Argentina.</div>
    </div>
  </div>

  <!-- Helper text -->
  <div id="heroText" class="text-block">
    <div style="font-size:12px; color:var(--muted); margin-bottom:4px">Group‑eSIM, simplified</div>
    <div style="font-size:20px; font-weight:800; line-height:1.1">Pick a region. We’ll spin you there.</div>
    <div style="font-size:13px; color:var(--muted); margin-top:6px">Buy for yourself now — invite friends later. One plan, multiple travelers, on your terms.</div>
  </div>

  <!-- Scroll indicator -->
  <div id="scrollInd" class="scroll-ind" aria-hidden="true">
    <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="var(--orange)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
  </div>

  <!-- Referral strip -->
  <div class="ref-strip">
    <span>Traveling with friends? Earn £xxx credit per referral — Invite Friends</span>
    <button id="invite">Invite</button>
  </div>

  <!-- Share modal -->
  <div id="share" class="share" aria-hidden="true">
    <div class="sheet">
      <h3 style="margin:0 0 8px 0">Invite friends</h3>
      <p style="margin:0 0 10px 0; color:#c9c9c9">Share your link and earn £xxx credit per referral.</p>
      <div class="row">
        <input id="refLink" value="https://durasim.example/ref?code=YOUR-CODE" readonly />
        <button id="copy">Copy</button>
      </div>
    </div>
  </div>

  <!-- Three.js -->
  <script src="https://unpkg.com/three@0.158.0/build/three.min.js"></script>

  <script>
  (function(){
    const log = (...args)=>console.log('[DEBUG]', ...args);

    // Stars
    const stars = document.getElementById('stars');
    const sctx = stars.getContext('2d');
    const STAR_COUNT = 180;
    const starField = Array.from({length:STAR_COUNT}, ()=>({ x: Math.random(), y: Math.random(), r: Math.random()*1.3 + .2, o: .3 + Math.random()*.7 }));

    // Three.js scene
    const stage = document.getElementById('three-stage');
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(45, 1, 0.1, 100);
    const renderer = new THREE.WebGLRenderer({ antialias:true, alpha:true });
    stage.appendChild(renderer.domElement);

    const RADIUS = 1.4; // globe size
    camera.position.set(0, 0.15, 3.2);

    // Lights
    const amb = new THREE.AmbientLight(0xffffff, 0.65); scene.add(amb);
    const dir = new THREE.DirectionalLight(0xffffff, 1.0); dir.position.set(5,3,5); scene.add(dir);

    // Earth texture
    const TEX_URL = 'https://unpkg.com/three@0.158.0/examples/textures/land_ocean_ice_cloud_2048.jpg';
    const loader = new THREE.TextureLoader();
    const earthGeo = new THREE.SphereGeometry(RADIUS, 96, 96);
    const earthMat = new THREE.MeshPhongMaterial({ map: loader.load(TEX_URL), shininess: 8 });
    const earth = new THREE.Mesh(earthGeo, earthMat); scene.add(earth);

    // Atmosphere
    const atmoGeo = new THREE.SphereGeometry(RADIUS*1.03, 64, 64);
    const atmoMat = new THREE.MeshBasicMaterial({ color: 0xFF6B35, transparent:true, opacity:0.08, blending: THREE.AdditiveBlending });
    const atmo = new THREE.Mesh(atmoGeo, atmoMat); scene.add(atmo);

    // Resize
    function resize(){
      const w = window.innerWidth, h = window.innerHeight;
      stars.width = w; stars.height = h;
      renderer.setSize(w, h, false);
      camera.aspect = w/h; camera.updateProjectionMatrix();
      drawStars(0);
    }

    // Regions
    const regions = [
      { key:'asia',     name:'Asia',     lat:  1.3, lon: 103.8 },
      { key:'europe',   name:'Europe',   lat: 50.1, lon:   8.6 },
      { key:'americas', name:'Americas', lat: 19.4, lon: -99.1 }
    ];
    function yawPitchFor(lat,lon){
      const toRad = Math.PI/180;
      const yaw = -lon*toRad;
      const pitch = lat*toRad;
      return { yaw, pitch: -pitch*0.5 };
    }

    // Rotation targets
    let targetYaw = yawPitchFor(regions[0].lat, regions[0].lon).yaw;
    let targetPitch = yawPitchFor(regions[0].lat, regions[0].lon).pitch;
    let yaw = targetYaw; let pitch = targetPitch;
    let regionIndex = 0;

    // Scroll navigate regions (optional)
    const STEP = 30 * Math.PI/180;
    let firstScroll = true;
    function stepToRegion(dir){
      regionIndex = (regionIndex + (dir>0?1:-1) + regions.length) % regions.length;
      focusRegion(regions[regionIndex].key);
      log('scroll-step -> region', regions[regionIndex].key);
    }
    function onWheel(e){
      e.preventDefault();
      if(firstScroll){ document.getElementById('scrollInd').classList.add('hide'); firstScroll=false; }
      const dir = Math.sign(e.deltaY);
      stepToRegion(dir);
    }
    window.addEventListener('wheel', onWheel, {passive:false});

    // Project lat/lon to screen
    const tmp = new THREE.Vector3();
    function projectLatLon(lat,lon){
      const toRad = Math.PI/180; const phi = (90-lat)*toRad; const theta = (lon+180)*toRad;
      const r = RADIUS*1.01;
      const x = -r * Math.sin(phi) * Math.cos(theta);
      const z =  r * Math.sin(phi) * Math.sin(theta);
      const y =  r * Math.cos(phi);
      tmp.set(x,y,z);
      tmp.applyAxisAngle(new THREE.Vector3(1,0,0), pitch);
      tmp.applyAxisAngle(new THREE.Vector3(0,1,0), yaw);
      tmp.project(camera);
      return {
        x: (tmp.x * 0.5 + 0.5) * renderer.domElement.clientWidth,
        y: (-tmp.y * 0.5 + 0.5) * renderer.domElement.clientHeight,
        visible: tmp.z < 1
      };
    }

    // Hotspots
    const hs = {
      asia: document.getElementById('hs-asia'),
      europe: document.getElementById('hs-europe'),
      americas: document.getElementById('hs-americas')
    };
    function placeHotspots(){
      regions.forEach(r=>{
        const p = projectLatLon(r.lat, r.lon);
        const el = hs[r.key];
        el.style.left = p.x+'px'; el.style.top = p.y+'px'; el.style.opacity = p.visible ? 1 : 0.2;
      });
    }

    // Plans interactions (static panel)
    const planEls = Array.from(document.querySelectorAll('.plan'));
    function setSelected(key){
      planEls.forEach(el=> el.classList.toggle('sel', el.dataset.key===key));
    }
    function focusRegion(key){
      const r = regions.find(x=>x.key===key);
      if(!r) return;
      const t = yawPitchFor(r.lat, r.lon);
      targetYaw = Math.round(t.yaw/STEP)*STEP;
      targetPitch = t.pitch;
      setSelected(key);
      log('focus', key);
    }
    // Click on plan or its button
    planEls.forEach(el=>{
      el.addEventListener('click', (e)=>{
        const key = el.dataset.key; focusRegion(key);
      });
      el.querySelector('.btn').addEventListener('click', (e)=>{
        e.stopPropagation();
        const key = el.dataset.key; focusRegion(key); log('cta', {region:key, action:'choose-plan'});
      });
    });

    // Hotspot clicks also select plan
    Object.entries(hs).forEach(([key,el])=>{
      el.addEventListener('click', ()=>{ focusRegion(key); });
    });

    // Header/nav
    const nav = document.getElementById('navOverlay');
    document.getElementById('burger').addEventListener('click', ()=>{ nav.classList.add('open'); log('nav','open'); });
    document.getElementById('closeNav').addEventListener('click', ()=>{ nav.classList.remove('open'); log('nav','close'); });
    nav.addEventListener('click', (e)=>{ if(e.target===nav){ nav.classList.remove('open'); log('nav','close-backdrop'); } });

    // Referral
    const share = document.getElementById('share');
    document.getElementById('invite').addEventListener('click', ()=>{ share.classList.add('open'); log('referral','open'); });
    share.addEventListener('click', (e)=>{ if(e.target===share){ share.classList.remove('open'); log('referral','close-backdrop'); } });
    document.getElementById('copy').addEventListener('click', ()=>{ const v = document.getElementById('refLink').value; navigator.clipboard && navigator.clipboard.writeText(v); log('referral','copy', v); });

    // Stars draw
    function drawStars(offsetY){
      const w = stars.width, h = stars.height;
      sctx.clearRect(0,0,w,h);
      for(const s of starField){
        const px = s.x * w;
        const py = (s.y * h) + offsetY * (0.08 + s.r*0.02);
        sctx.beginPath(); sctx.arc(px, ((py%h)+h)%h, s.r, 0, Math.PI*2); sctx.closePath();
        sctx.fillStyle = `rgba(255,255,255,${s.o})`; sctx.fill();
      }
    }

    // Animation loop
    let lastRegionIdx=-1;
    function animate(){
      // ease rotations
      const snap = Math.round(targetYaw/STEP)*STEP; if(Math.abs(targetYaw-snap) < (5*Math.PI/180)) targetYaw = snap;
      yaw += (targetYaw - yaw) * 0.07;
      pitch += (targetPitch - pitch) * 0.07;
      earth.rotation.y = yaw; earth.rotation.x = pitch; atmo.rotation.copy(earth.rotation);

      renderer.render(scene, camera);
      drawStars(window.scrollY * -0.15);
      placeHotspots();

      // Update selected plan by closest yaw
      let minD = 1e9, idx=0; regions.forEach((r,i)=>{ const ty = yawPitchFor(r.lat, r.lon).yaw; const d = Math.abs(((yaw-ty+Math.PI*3)%(Math.PI*2))-Math.PI); if(d<minD){minD=d; idx=i;} });
      if(idx!==lastRegionIdx){ lastRegionIdx=idx; setSelected(regions[idx].key); log('region', regions[idx].key); }
      requestAnimationFrame(animate);
    }

    // Init
    window.addEventListener('resize', resize); resize();
    document.getElementById('heroText').classList.add('show');
    setSelected('asia');
    animate();
  })();
  </script>
</body>
</html>
